#!/bin/sh

## -----------------------------------------------------------------------------
## This shell script can be used to update the local code base (as part of the
## USG code repository) against a more recent snapshot obtained from the CASA
## code repository.
## -----------------------------------------------------------------------------

## check the path for the reference code base

if [[ -f $1/VERSION ]] ; then
	casa_source=$1
else
	if  [[ -f $1/code/VERSION ]] ; then
		casa_source=$1/code
	else
		casa_source=""
	fi
fi

if [[ -z $casa_source ]] ; then
	echo "Unable to set path to CASA code tree";
	exit;
fi

## go through the list of packages

packages="casa coordinates fits lattices measures ms scimath tables"

for package in $packages
{
	echo "$package ..."
	modules=`ls $package/implement`
	for module in $modules
	{
		dir=$package/implement/$module
		if [[ -d $dir ]] ; then
			echo "-- $dir"
			## copy the source files
			cp $casa_source/$dir/*.h $dir
			cp $casa_source/$dir/*.cc $dir
			## make sure all files are under version control
			svn add $dir/*.h
			svn add $dir/*.cc
		fi
	}
}
