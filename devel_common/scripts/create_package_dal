#!/bin/sh

##------------------------------------------------------------------------------
## $Id                                                                         $
##------------------------------------------------------------------------------

##------------------------------------------------------------------------------
## When called, make sure, that the script is running from the correct location.

echo "[DAL packager] Checking location for the script to run ..."

if test -d src ; then
    echo " --> Found directory src"
    if test -d external ; then
	echo " --> Found directory external"
    else
	exit 1;
    fi
else
    exit 1;
fi

##------------------------------------------------------------------------------
## Check that we have a clean start: if there already is a tar-archive around,
## remove it.

echo "[DAL packager] Cleaning source directory ...";

if test -f dal.tgz ; then
    echo " --> Found previously created tar archive; removing it."
    rm -f dal.tgz
fi

##------------------------------------------------------------------------------
## List of packages and their location in the source tree

# ./usg
# |-- build
# |-- devel_common
# |-- external
# |   |-- boost
# |   |-- casacore
# |   |-- cmake
# |   |-- cfitsio
# |   |-- hdf5
# |   `-- wcs
# `-- src
#     `-- DAL

echo "[DAL packager] Running tar to package source directories ..."

external_packages="cmake cfitsio casacore hdf5 boost python wcslib"

for package in $external_packages
{
    packages="${packages} external/$package"
}

tar -cvzf dal.tgz ${packages} src/DAL CMakeLists.txt devel_common release/release_area.txt build/build.sh --exclude .svn
