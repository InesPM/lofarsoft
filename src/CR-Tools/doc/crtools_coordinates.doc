/* $Id$ */

/*!
  \defgroup CR_Coordinates CR-Tools :: Coordinates module
  \ingroup CR

  \brief Coordinates module for the CR-pipeline
  
  - \ref crtools_coordinates_types
  - \ref crtools_coordinates_conversions
  - \ref crtools_coordinates_references

  <hr>

  \section crtools_coordinates_conventions Basic conventions

  The <b>spherical coordinate</b> system represents points as a tuple of three
  components. For use in physical sciences and technology, the recommended
  international standard notation is \f$ r,\vartheta,\phi \f$ for distance,
  zenith and azimuth (ISO 31-11). (In the standard \f$\vartheta\f$ is preferred
  to \f$\theta\f$, although it is the same Greek letter). Otherwise, in America
  the components are typically notated as \f$(\rho,\phi,\theta)\f$ for
  distance, zenith and azimuth, while elsewhere the notation is reversed for
  zenith and azimuth as \f$(\rho,\theta,\phi)\f$. The former has the advantage
  of being most compatible with the notation for the two-dimensional polar
  coordinate system and the three-dimensional cylindrical coordinate system,
  while the latter has the broader acceptance geographically. The notation
  convention of the author of any work pertaining to spherical coordinates
  should always be checked before using the formulas and equations of that
  author. [from Wikipedia, english version]

  We here use the three coordinates \f$(r,\phi,\theta)\f$ according to the
  following convention:
  <ul>
    <li>\f$r\f$ (radius) is the distance of a point P from the origin O of the
    coordinate system, i.e. the length of the vector \f$\vec r\f$;
    <li>\f$\phi\f$ (azimuth angle) is the angle between the positive x-axis and
    \f$\vec r_{xy}\f$ (i.e. the projection of the vector \f$\vec r\f$ onto the
    x-y-plane), with values running from 0 to \f$2\pi\f$ (\f$0^\circ\f$ to
    \f$360^\circ\f$) counted counter-clockwise
    <li>\f$\theta\f$ (polar angle) is the angle between the positive z-axis
    and the vector \f$\vec r\f$, with values running from 0 to \f$\pi\f$
    (\f$0^\circ\f$ to \f$180^\circ\f$)
  </ul>

  For <b>cylindrical coordinates</b> we closely follow the above convention,
  such that the azmiuthal angle \f$\phi\f$ in the x-y-plane is the same as for
  the case of spherical coordinates (and thereby reflection the relation of
  the cylindrical coordinates to polar coordinates in the plain).

  \image html coordinates.png

  <hr>
  
  \section crtools_coordinates_types Coordinate types
  
  The following list of coordinate type is implemented in CR::CoordinateType
  
  <table border=0>
    <tr>
      <td class="indexkey">Type</td>
      <td class="indexkey">Description</td>
      <td class="indexkey">Coordinates</td>
      <td class="indexkey">Comments</td>
    </tr>
    <tr>
	  <td>Direction</td>
	  <td>Direction on the sky</td>
	  <td>\f$ (Long,Lat) \f$</td>
	  <td></td>
	</tr>
    <tr>
	  <td>DirectionRadius</td>
	  <td>Direction on the sky with radial distance</td>
	  <td>\f$ (Long,Lat,R) \f$</td>
	  <td>Encapsulated through CR::SpatialCoordinate</td>
	</tr>
    <tr>
	  <td>Cartesian</td>
	  <td>Cartesian coordinates</td>
	  <td>\f$ (x,y,z) \f$</td>
	  <td>Encapsulated through CR::SpatialCoordinate</td>
	</tr>
    <tr>
	  <td>Spherical</td>
	  <td>Spherical coordinates</td>
	  <td>\f$ (r,\phi,\theta) \f$</td>
	  <td>Encapsulated through CR::SpatialCoordinate</td>
	</tr>
    <tr>
	  <td>Cylindrical</td>
	  <td>Cylindrical coordinates</td>
	  <td>\f$ (\rho,\phi,z) \f$</td>
	  <td></td>
	</tr>
    <tr>
	  <td>AzElHeight</td>
	  <td>Azimuth-Elevation-Height</td>
	  <td>\f$ (Az,El,H) \f$</td>
	  <td></td>
	</tr>
    <tr>
	  <td>AzElRadius</td>
	  <td>Azimuth-Elevation-Radius</td>
	  <td>\f$ (Az,El,R) \f$</td>
	  <td></td>
	</tr>
    <tr>
	  <td>NorthEastHeight</td>
	  <td></td>
	  <td></td>
	  <td></td>
	</tr>
    <tr>
	  <td>LongLatRadius</td>
	  <td>(Local) Longitude-Latitude-Radius</td>
	  <td>\f$ (Long,Lat,R) \f$</td>
	  <td></td>
	</tr>
    <tr>
	  <td>Time</td>
	  <td></td>
	  <td></td>
	  <td></td>
	</tr>
    <tr>
	  <td>Frequency</td>
	  <td></td>
	  <td></td>
	  <td></td>
	  <td></td>
	</tr>
    <tr>
	  <td></td>
	  <td></td>
	  <td></td>
	  <td></td>
	</tr>
  </table>

  <hr>
  
  \section crtools_coordinates_conversions Coordinate conversions
  
  <ol>

    <li>CR::CoordinateType::Cartesian \f$ (x,y,z) \f$
	
	  <table>
        <tr>
	      <td class="indexkey">... as function of</td>
	      <td class="indexkey">Forward transform</td>
	      <td class="indexkey">\f$ (x,y,z) \f$ to other</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Spherical <br> \f$ (r,\phi,\theta) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} r \sin(\theta) \cos(\phi) \\ r \sin(\theta)
		  \sin(\phi) \\ r \cos(\theta) \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \sqrt{x^2 + y^2 + z^2} \\[1mm] \mathrm{atan}
		  \left( y/x \right) \\[1mm] \mathrm{acos} \left( \frac{z}{\sqrt{x^2 + y^2
		  + z^2}} \right) \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Cylindrical <br> \f$ (\rho,\phi,z) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \rho \cos(\phi) \\ \rho \sin(\phi) \\ z
		  \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \sqrt{x^2 + y^2} \\ \mathrm{atan}(y/x) \\ z
		  \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::AzElRadius <br> \f$ (Az,El,R) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} R \cos(El) \sin(Az) \\ R \cos(El) \cos(Az) \\ R
		  \sin(El) \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \mathrm{atan}(x/y) \\ \mathrm{asin}(z/\sqrt{x^2
		  + y^2 + z^2}) \\ \sqrt{x^2 + y^2 + z^2} \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::AzElHeight <br> \f$ (Az,El,H) \f$</td>
	      <td>\f$ \left[ \begin{array}{l}  \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l}  \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::LongLatRadius <br> \f$ (Long,Lat,R) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} R \cos(Lat) \cos(Long) \\ R \cos(Lat) \sin(Long)
		  \\ R \sin(Lat) \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \mathrm{atan}(y/x) \\ \mathrm{asin}(z/\sqrt{x^2
		  + y^2 + z^2}) \\ \sqrt{x^2 + y^2 + z^2} \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::NorthEastHeight <br> \f$ (N,E,H) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} E \\ N \\ H \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} y \\ x \\ z \end{array} \right] \f$</td>
	    </tr>
	  </table>

    <li>CR::CoordinateType::Spherical \f$ (r,\phi,\theta) \f$
	
	  <table>
        <tr>
	      <td class="indexkey">... as function of</td>
	      <td class="indexkey">Forward transform</td>
	      <td class="indexkey">\f$ (r,\phi,\theta) \f$ to other</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Cartesian <br> \f$ (x,y,z) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \sqrt{x^2 + y^2 + z^2} \\ \mathrm{atan}(y/x) \\
		  \mathrm{acos}(z/\sqrt{x^2 + y^2 + z^2}) \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} r \sin(\theta) \cos(\phi) \\ r \sin(\theta)
		  \sin(\phi) \\ r \cos(\theta) \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Cylindrical <br> \f$ (\rho,\phi,z) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \sqrt{\rho^2+z^2} \\ \phi \\
		  \mathrm{atan}(\rho/z) \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} r \sin(\theta) \\ \phi \\ r \cos(\theta)
		  \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::AzElRadius <br> \f$ (Az,El,R) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} R \\ 90^{\circ}-Az \\ 90^{\circ}-El \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} 90^{\circ}-\phi \\ 90^{\circ}-\theta \\ r
		  \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::LongLatRadius <br> \f$ (Long,Lat,R) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} R \\ Long \\ 90^{\circ}-Lat \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \phi \\ 90^{\circ}-\theta \\ r \end{array} \right] \f$</td>
	    </tr>
	  </table>

    <li>CR::CoordinateType::Cylindrical \f$ (\rho,\phi,z) \f$

	  <table>
        <tr>
	      <td class="indexkey">... as function of</td>
	      <td class="indexkey">Forward transform</td>
	      <td class="indexkey">\f$ (\rho,\phi,z) \f$ to other</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Cartesian <br> \f$ (x,y,z) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \sqrt{x^2 + y^2} \\ \mathrm{atan}(y/x) \\ z
		  \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \rho \cos(\phi) \\ \rho \sin(\phi) \\ z
		  \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Spherical <br> \f$ (r,\phi,\theta) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} r \sin(\theta) \\ \phi \\ r \cos(\theta)
		  \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \sqrt{\rho^2+z^2} \\ \phi \\
		  \mathrm{atan}(\rho/z) \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::AzElRadius <br> \f$ (Az,El,R) \f$</td>
	      <td>\f$ \left[ \begin{array}{l}  \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l}  \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::LongLatRadius <br> \f$ (Long,Lat,R) \f$</td>
	      <td>\f$ \left[ \begin{array}{l}  \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l}  \end{array} \right] \f$</td>
	    </tr>
	  </table>

    <li>CR::CoordinateType::AzElRadius \f$ (Az,El,R) \f$

	  <table>
        <tr>
	      <td class="indexkey">... as function of</td>
	      <td class="indexkey">Forward transform</td>
	      <td class="indexkey">\f$ (Az,El,R) \f$ to other</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Cartesian <br> \f$ (x,y,z) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \mathrm{atan}(x/y) \\ \mathrm{asin}(z/\sqrt{x^2
		  + y^2 + z^2}) \\ \sqrt{x^2 + y^2 + z^2} \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} R \cos(El) \sin(Az) \\ R \cos(El) \cos(Az) \\ R
		  \sin(El) \end{array} \right] \f$</td>
	    </tr>
	  </table>

    <li>CR::CoordinateType::LongLatRadius \f$ (Long,Lat,R) \f$

	  <table>
        <tr>
	      <td class="indexkey">... as function of</td>
	      <td class="indexkey">Forward transform</td>
	      <td class="indexkey">\f$ (Long,Lat,R) \f$ to other</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Cartesian <br> \f$ (x,y,z) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \mathrm{atan}(y/x) \\ \mathrm{asin}(z/\sqrt{x^2
		  + y^2 + z^2}) \\ \sqrt{x^2 + y^2 + z^2} \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} R \cos(Lat) \cos(Long) \\ R \cos(Lat) \sin(Long)
		  \\ R \sin(Lat) \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::Spherical <br> \f$ (r,\phi,\theta) \f$</td>
	      <td>\f$ \left[ \begin{array}{l} \phi \\ 90^{\circ}-\theta \\ r \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l} R \\ Long \\ 90^{\circ}-Lat \end{array} \right] \f$</td>
	    </tr>
        <tr>
	      <td>CR::CoordinateType::AzElRadius <br> \f$ (Az,El,R) \f$</td>
	      <td>\f$ \left[ \begin{array}{l}  \end{array} \right] \f$</td>
	      <td>\f$ \left[ \begin{array}{l}  \end{array} \right] \f$</td>
	    </tr>
	  </table>

  </ol>

  <hr>
  
  \section crtools_coordinates_references References
  
  - casacore <a href="http://www.astron.nl/casacore/doc/html/group__Coordinates__module.html">Coordinates</a>
  module, collecting classes to interconvert pixel and world (physical)
  coordinates.
  - <a href="http://en.wikipedia.org/wiki/Geographic_coordinate">Geographic coordinate
  system</a> (Wikipedia)
  
*/
